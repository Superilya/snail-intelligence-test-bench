# Улитки

### Описание

Игра по механике трон

![Игра](https://media.giphy.com/media/2UEUyhlqapCw56K4Qw/giphy.gif)

![Игра](https://s8.hostingkartinok.com/uploads/images/2018/11/82d7aaa304ca8a0df42de70148af2526.gif)

Но игроки - улитки.

### Механика работы игры

Движок игры запускается в браузере или на сервере. В игру передаётся объект с конфигурацией вида

```
const initial = {
    field: { // размеры поля
        width: 12,
        height: 12
    },
    players: [ // массив с игроками
        {
            host: '/client', // адрес сервера игрока (передаётся в whatwg fetch)
            startPosition: { // начальная позиция игрока
                left: 5,
                top: 5
            }
        },
        {
            host: '/client1',
            startPosition: {
                left: 10,
                top: 10
            }
        }
    ]
};
```

При запуске игра одновременно опрашивает игроков отправляя размеры поля и позиции игроков, в ответ должна получить id игры который зарегистрирован у игрока и первый ход, так как все данные для него есть.

Далее игра одновременно опрашивает игроков, передавая им id игры и ходы соперников и получая в ответ ход игрока.

Id игры на стороне игрока нужен, чтобы игрок мог учавствовать в нескольких играх одновременно.

Если игрок наступает на чей либо след, в том числе и свой, то проигрывает. В этом случае игра отправляет сообщение, что игрок проиграл и больше не опрашивает его.

Когда остался последний игрок, ему отправляется сообщение, что он выиграл. Дальнейшие вызовы игра игнорирует.

### Спецификация для сервера/игрока

Все запросы игроку делаются по http методом POST с заголовком `'Content-Type': 'application/json'`. В теле запроса всегда валидный JSON или ничего. 

**/init**

Запрос

```
{
    field: { // размеры поля
        width: 12,
        height: 12
    },
    startPosition: { // начальная позиция твоего игрока
        left: 5,
        top: 5
    },
    players: { // начальные позиции соперников
        0: { // id соперника
            left: 10,
            top: 10
        },
        1: { // id соперника
            left: 10,
            top: 10
        }
    }
}
```

Ответ

```
{
    id: 0, // id игры
    move: 'LEFT' // первый ход игрока
}
```

**/tick/:gameId**

Запрос

```
{
    0: 'UP', // перемещения соперников в прошлом ходе
    1: 'DOWN'
}
```

Ответ

```
{
    move: 'RIGHT' // ход игрока
}
```

**/dead/:gameId**

Запрос

```
{
    markId: 0 // id игрока на чей след наступил игрок
}
```

**/win/:gameId**

### Использование тестового стенда

Запускаем свой сервер-улитку на локальной машине, в ./src/config указываем до неё путь из Docker контейнера и

```
npm run docker-build
npm run docker-run
```

для JavaScript бояр есть клиент в пакете snail-intelligence-client, пример использования в ./src